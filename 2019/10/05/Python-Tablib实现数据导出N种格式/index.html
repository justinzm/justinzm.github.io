<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>草根之明</title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_859455_eaq7v6w8ktj.css">
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
<header class="header">
    <div class="header-inner">
        <div class="header-title">

        </div>
        <nav class="header-nav">
            
            <a href="/" class="header-nav-link" >
                首页
            </a>
            

            
            <a href="/archives" class="header-nav-link">
                归档
            </a>
            

            
            <a href="/tags" class="header-nav-link">
                标签
            </a>
            

            
            <a href="/about/" class="header-nav-link">
                关于
            </a>
            
        </nav>
    </div>
</header>
<header class="mobile-header">
    <div class="mobile-nav">
        <div class="mobile-nav-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="mobile-nav-title">
            <a href="/" class="mobile-nav-title-link">Justin ZM's Blog</a>
        </div>

    </div>
    <nav class="mobile-menu">
        <ul class="mobile-menu-list">
            <li class="mobile-menu-item">
                <i class="iconfont icon-home"></i>
                <a href="/" class="mobile-nav-link">首页</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-archive"></i>
                <a href="/archives" class="mobile-nav-link">归档</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-tag"></i>
                <a href="/tags" class="mobile-nav-link">标签</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-about"></i>
                <a href="/about/" class="mobile-nav-link">关于</a>
            </li>
        </ul>
    </nav>
</header>
<div class="main">
    <div class="content-inner">
        <div class="posts">
    <article class="post-whole">
        <div class="post-title">
            <h2 class="title">Python Tablib实现数据导出N种格式</h2>
            <div class="post-meta">
                <span class="post-time">2019-10-05</span>
                
                <span class="post-category">
                    
                    <a class="category" href="/categories/Python/">Python</a>
                    
                </span>
                
                <span class="post-visit"> 阅读次数：<span id="busuanzi_value_page_pv"></span></span>
            </div>
        </div>
        <div class="post-toc" id="post-toc">
    <strong class="post-toc-title">目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%87%E8%A7%81-Tablib"><span class="toc-text">遇见 Tablib</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tablib-%E5%AE%89%E8%A3%85"><span class="toc-text">Tablib 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-text">创建数据集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%A1%8C"><span class="toc-text">添加行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%88%97"><span class="toc-text">添加列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E8%A1%8C%E5%92%8C%E5%88%97"><span class="toc-text">选择行和列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%8C"><span class="toc-text">删除行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%88%97"><span class="toc-text">删除列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="toc-text">数据格式转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA"><span class="toc-text">数据导出</span></a></li></ol>
    <div class="back-to-top" id="back-to-top">
        <a href="javascript:void(0);">回到顶部</a>
    </div>
</div>
        <div class="post-content">
            <h3 id="遇见-Tablib"><a href="#遇见-Tablib" class="headerlink" title="遇见 Tablib"></a>遇见 Tablib</h3><p>我们在 Python 实际开发过程中，经常涉及将数据导出为 Excel、Csv、Yaml、Json 等各种格式的文件的需求，一些粗鲁的实现方式是通过安装各种第三方模块以支持不同格式文件的导出操作。</p>
<p>接下来要我们要介绍的这个模块，再也不需要担心因导出不同格式数据时而调用各种第三方模块了，当然使用 Pandas 也是一个不错的选择，只是过于重量级了。</p>
<p>Python Tablib 是麻省理工学院授权的与格式无关的表格数据集库。支持导入、导出和操作表格数据集。优雅的将数据导出为各种不同的格式，包括Excel，Json，Html，Yaml，Csv，Tsv等格式。</p>
<h3 id="Tablib-安装"><a href="#Tablib-安装" class="headerlink" title="Tablib 安装"></a>Tablib 安装</h3><p>我们在 Windows10 Python3 环境下，使用 pip 进行安装 ，安装命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install tablib</span><br></pre></td></tr></table></figure>
<p>接下来，让我们一步步了解如何使用 Tablib ，简洁而又优雅的实现将数据导出为各种格式。</p>
<h3 id="创建数据集"><a href="#创建数据集" class="headerlink" title="创建数据集"></a>创建数据集</h3><p>我们使用 tablib.Dataset 方法，采用如下方式创建数据集：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 78],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line">print(dataset_o)</span><br><span class="line"></span><br><span class="line"># id|name|age|grade</span><br><span class="line"># --|----|---|-----</span><br><span class="line"># 1 |Troy|20 |78   </span><br><span class="line"># 2 |Orla|21 |89   </span><br><span class="line"># 3 |Cody|20 |96   </span><br><span class="line"># 4 |Yana|19 |77   </span><br><span class="line"># 5 |Maya|21 |59 </span><br></pre></td></tr></table></figure>
<p>我们还可以另一种方式创建数据集，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line">dataset_t = tablib.Dataset()</span><br><span class="line"></span><br><span class="line"># 添加表头 字段名或者列名</span><br><span class="line">dataset_t.headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 78],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">for t in data:</span><br><span class="line">    # 添加数据</span><br><span class="line">    dataset_t.append(t)</span><br><span class="line">print(dataset_t)</span><br><span class="line"></span><br><span class="line"># id|name|age|grade</span><br><span class="line"># --|----|---|-----</span><br><span class="line"># 1 |Troy|20 |78   </span><br><span class="line"># 2 |Orla|21 |89   </span><br><span class="line"># 3 |Cody|20 |96   </span><br><span class="line"># 4 |Yana|19 |77   </span><br><span class="line"># 5 |Maya|21 |59 </span><br></pre></td></tr></table></figure>

<p>我们还可以通过导入现有文件数据的方式创建数据集，如下，我们为 dump.json 文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[&quot;Jack&quot;, &quot;20&quot;], [&quot;Tom&quot;, &quot;30&quot;]]</span><br></pre></td></tr></table></figure>

<p>我们使用 tablib.Dataset.load 方法导入 dump.json 文件数据，实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line">dataset_json = tablib.Dataset().load(open(&#x27;dump.json&#x27;).read())</span><br><span class="line">print(dataset_json)</span><br><span class="line">print(dataset_json.json)</span><br><span class="line"></span><br><span class="line"># Jack|20</span><br><span class="line"># Tom |30</span><br><span class="line"># [[&quot;Jack&quot;, &quot;20&quot;], [&quot;Tom&quot;, &quot;30&quot;]]</span><br></pre></td></tr></table></figure>

<p>创建一个 tablib.Dataset 通过 load 方法，导入现已存在的文件。强大之处是 tablib 能够自动检测传入的文件类型，并使用适当的格式化方法进行导入，实现从各种不同的文件类型中导入。</p>
<p>比如，我们再导入 dataset.xlsx 文件，代码实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line">dataset_xlsx = tablib.Dataset().load(open(&#x27;dump.xlsx&#x27;).read())</span><br></pre></td></tr></table></figure>

<h3 id="添加行"><a href="#添加行" class="headerlink" title="添加行"></a>添加行</h3><p>我们可以使用 tablib.Dataset.append 方法，实现向数据集尾部添加行数据，需要注意的是每行的元素数量应与数据集的列数相同</p>
<p>我们也可以使用 tablib.Dataset.insert 方法，实现向数据集指定位置添加行数据，同样需要注意每行的元素数量应与数据集的列数相同</p>
<p>代码实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 78],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line"></span><br><span class="line"># 添加到最后一行的下面</span><br><span class="line">dataset_o.append([7, &#x27;Lucy&#x27;, 21, 68])</span><br><span class="line"></span><br><span class="line"># 向数据集的第6行，添加数据</span><br><span class="line">dataset_o.insert(5, [6, &#x27;Zoya&#x27;, 20, 99])</span><br><span class="line">print(dataset_o)</span><br><span class="line"></span><br><span class="line"># id|name|age|grade</span><br><span class="line"># --|----|---|-----</span><br><span class="line"># 1 |Troy|20 |78   </span><br><span class="line"># 2 |Orla|21 |89   </span><br><span class="line"># 3 |Cody|20 |96   </span><br><span class="line"># 4 |Yana|19 |77   </span><br><span class="line"># 5 |Maya|21 |59   </span><br><span class="line"># 6 |Zoya|20 |99   </span><br><span class="line"># 6 |Lucy|21 |68 </span><br></pre></td></tr></table></figure>

<h3 id="添加列"><a href="#添加列" class="headerlink" title="添加列"></a>添加列</h3><p>我们可以使用 tablib.Dataset.append_col 方法，实现向数据集<strong>尾部添加列数据</strong>，需要注意的是每列的元素数量应与数据集的行数相同。</p>
<p>我们也可以使用 tablib.Dataset.insert_col 方法，实现向数据集指定位置添加列数据，需要注意的是每列的元素数量应于数据集的行数相同，代码实现如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 78],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line"></span><br><span class="line"># 添加列到最后一列，数据集中有5行，因此该列数据应为5个元素</span><br><span class="line">dataset_o.append_col([&#x27;302&#x27;, &#x27;303&#x27;, &#x27;304&#x27;, &#x27;305&#x27;, &#x27;306&#x27;], header=&#x27;class&#x27;)</span><br><span class="line"></span><br><span class="line"># 在第3列添加新列，数据集中有5行，因此该列数据应为5个元素。</span><br><span class="line">dataset_o.insert_col(2, (&#x27;male&#x27;, &#x27;female&#x27;, &#x27;abc&#x27;, &#x27;efg&#x27;, &#x27;zxc&#x27;), header=&#x27;sex&#x27;)</span><br><span class="line"></span><br><span class="line">print(dataset_o)</span><br><span class="line"></span><br><span class="line"># id|name|sex   |age|grade|class</span><br><span class="line"># --|----|------|---|-----|-----</span><br><span class="line"># 1 |Troy|male  |20 |78   |302  </span><br><span class="line"># 2 |Orla|female|21 |89   |303  </span><br><span class="line"># 3 |Cody|abc   |20 |96   |304  </span><br><span class="line"># 4 |Yana|efg   |19 |77   |305  </span><br><span class="line"># 5 |Maya|zxc   |21 |59   |306 </span><br></pre></td></tr></table></figure>

<h3 id="选择行和列"><a href="#选择行和列" class="headerlink" title="选择行和列"></a>选择行和列</h3><p>我们可以像Python列表一样通过切片和索引获取行数据。像Python字典通过列名和索引获取列数据，代码实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 78],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line"></span><br><span class="line"># 获得表头</span><br><span class="line">print(dataset_o.headers)</span><br><span class="line"></span><br><span class="line"># 获取第一行</span><br><span class="line">print(dataset_o[0])</span><br><span class="line"></span><br><span class="line"># 获取grade列</span><br><span class="line">print(dataset_o[&#x27;grade&#x27;])</span><br><span class="line"></span><br><span class="line"># 获取最后一行</span><br><span class="line">print(dataset_o[-1])</span><br><span class="line"></span><br><span class="line"># [&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;]</span><br><span class="line"># (1, &#x27;Troy&#x27;, 20, 78)</span><br><span class="line"># [78, 89, 96, 77, 59]</span><br><span class="line"># (5, &#x27;Maya&#x27;, 21, 59)</span><br></pre></td></tr></table></figure>

<h3 id="删除行"><a href="#删除行" class="headerlink" title="删除行"></a>删除行</h3><p>我们可以使用以下方式，实现行删除：</p>
<ul>
<li>tablib.Dataset.pop ：删除最后一行</li>
<li>tablib.Dataset.lpop ：删除第一行</li>
<li>del dataset[n: m] ：删除指定范围的行</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 78],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line"></span><br><span class="line"># 删除最后一行</span><br><span class="line">dataset_o.pop()</span><br><span class="line"></span><br><span class="line"># 删除第一行</span><br><span class="line">dataset_o.lpop()</span><br><span class="line"></span><br><span class="line"># 删除第[2,)行数据，只保留前两行</span><br><span class="line">del dataset_o[2:]</span><br><span class="line"></span><br><span class="line">print(dataset_o)</span><br><span class="line"></span><br><span class="line"># id|name|age|grade</span><br><span class="line"># --|----|---|-----</span><br><span class="line"># 2 |Orla|21 |89   </span><br><span class="line"># 3 |Cody|20 |96   </span><br></pre></td></tr></table></figure>

<h3 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h3><p>我们可以使用 del dataset[‘column_name’] ，实现删除指定列，代码实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 78],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line"></span><br><span class="line"># 删除age列</span><br><span class="line">del dataset_o[&#x27;age&#x27;]</span><br><span class="line"></span><br><span class="line">print(dataset_o)</span><br><span class="line"></span><br><span class="line"># id|name|grade</span><br><span class="line"># --|----|-----</span><br><span class="line"># 1 |Troy|78   </span><br><span class="line"># 2 |Orla|89   </span><br><span class="line"># 3 |Cody|96   </span><br><span class="line"># 4 |Yana|77   </span><br><span class="line"># 5 |Maya|59   </span><br></pre></td></tr></table></figure>

<h3 id="数据格式转换"><a href="#数据格式转换" class="headerlink" title="数据格式转换"></a>数据格式转换</h3><p>我们可以将数据集转换为如下任一格式，强无敌。</p>
<ul>
<li>Excel ( 支持Books)</li>
<li>Json ( 支持Books)</li>
<li>Yaml (支持 Books)</li>
<li>Pandas DataFrames</li>
<li>Csv</li>
<li>Html</li>
<li>Jira</li>
<li>Tsv</li>
<li>Ods</li>
<li>Dbf</li>
<li>Dict</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 20],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line"></span><br><span class="line">print(dataset_o.yaml)</span><br><span class="line">print(dataset_o.csv)</span><br><span class="line">print(dataset_o.json)</span><br><span class="line">print(dataset_o.df)</span><br><span class="line"></span><br><span class="line"># - age: 20</span><br><span class="line">#   grade: 20</span><br><span class="line">#   id: 1</span><br><span class="line">#   name: Troy</span><br><span class="line"># - age: 21</span><br><span class="line">#   grade: 89</span><br><span class="line">#   id: 2</span><br><span class="line">#   name: Orla</span><br><span class="line"># - age: 20</span><br><span class="line">#   grade: 96</span><br><span class="line">#   id: 3</span><br><span class="line">#   name: Cody</span><br><span class="line"># - age: 19</span><br><span class="line">#   grade: 77</span><br><span class="line">#   id: 4</span><br><span class="line">#   name: Yana</span><br><span class="line"># - age: 21</span><br><span class="line">#   grade: 59</span><br><span class="line">#   id: 5</span><br><span class="line">#   name: Maya</span><br><span class="line"># </span><br><span class="line"># id,name,age,grade</span><br><span class="line"># 1,Troy,20,20</span><br><span class="line"># 2,Orla,21,89</span><br><span class="line"># 3,Cody,20,96</span><br><span class="line"># 4,Yana,19,77</span><br><span class="line"># 5,Maya,21,59</span><br><span class="line"># </span><br><span class="line"># [&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;Troy&quot;, &quot;age&quot;: 20, &quot;grade&quot;: 20&#125;, &#123;&quot;id&quot;: 2, &quot;name&quot;: &quot;Orla&quot;, &quot;age&quot;: 21, &quot;grade&quot;: 89&#125;, &#123;&quot;id&quot;: 3, &quot;name&quot;: &quot;Cody&quot;, &quot;age&quot;: 20, &quot;grade&quot;: 96&#125;, &#123;&quot;id&quot;: 4, &quot;name&quot;: &quot;Yana&quot;, &quot;age&quot;: 19, &quot;grade&quot;: 77&#125;, &#123;&quot;id&quot;: 5, &quot;name&quot;: &quot;Maya&quot;, &quot;age&quot;: 21, &quot;grade&quot;: 59&#125;]</span><br><span class="line">#    id  name  age  grade</span><br><span class="line"># 0   1  Troy   20     20</span><br><span class="line"># 1   2  Orla   21     89</span><br><span class="line"># 2   3  Cody   20     96</span><br><span class="line"># 3   4  Yana   19     77</span><br><span class="line"># 4   5  Maya   21     59</span><br></pre></td></tr></table></figure>

<h3 id="数据导出"><a href="#数据导出" class="headerlink" title="数据导出"></a>数据导出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import tablib</span><br><span class="line"></span><br><span class="line"># 表头 字段名或者列名</span><br><span class="line">headers = (&#x27;id&#x27;, &#x27;name&#x27;, &#x27;age&#x27;, &#x27;grade&#x27;)</span><br><span class="line"># 数据</span><br><span class="line">data = [</span><br><span class="line">    [1, &#x27;Troy&#x27;, 20, 20],</span><br><span class="line">    [2, &#x27;Orla&#x27;, 21, 89],</span><br><span class="line">    [3, &#x27;Cody&#x27;, 20, 96],</span><br><span class="line">    [4, &#x27;Yana&#x27;, 19, 77],</span><br><span class="line">    [5, &#x27;Maya&#x27;, 21, 59],</span><br><span class="line">]</span><br><span class="line">                          </span><br><span class="line"># 创建数据集</span><br><span class="line">dataset_o = tablib.Dataset(*data, headers=headers)</span><br><span class="line"></span><br><span class="line"># 设置标签（sheet）</span><br><span class="line">dataset_o.title = &#x27;dataset_o&#x27;</span><br><span class="line">with open(&#x27;dataset_o.xlsx&#x27;, &#x27;wb&#x27;) as xlsx:</span><br><span class="line">    xlsx.write(dataset_o.xlsx)</span><br></pre></td></tr></table></figure>
<p>使用DataBook 导出多页数据</p>

        </div>
        
    </article>
</div>
<div class="paginator">
    
        
            <a class="prev" href="/2019/10/06/python%E7%9A%845%E7%A7%8D%E5%AE%9E%E6%88%98%E5%B0%8F%E6%8A%80%E5%B7%A7/">
                <i class="iconfont icon-prev"></i>
                <span class="nav-default">python的5种实战小技巧</span>
                <span class="nav-mobile">上一篇</span>
            </a>
        
        
            <a class="next" href="/2019/10/05/python%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/">
                <span class="nav-default">python实用技巧</span>
                <span class="nav-mobile">下一篇</span>
                <i class="iconfont icon-next"></i>
            </a>
        
    
</div>
<div id="comment-container"></div>
    </div>
</div>
<footer class="footer-social">
    

    

    

    <div class="footer-copyright">
        <p class="time-line">
            &copy;
            
            
            2022
            &nbsp;<i class="iconfont icon-heart"></i>&nbsp;
            <a target="_blank" href="https://github.com/iJinxin">Justin ZM</a>
        </p>
        <p class="theme-info">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  Theme -
            <a target="_blank" href="https://github.com/iJinxin/hexo-theme-sky">Sky</a>
        </p>
    </div>
</footer>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    

</script>
</html>
